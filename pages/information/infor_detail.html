<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
		<link href="../../css/publicStyle.css" rel="stylesheet" />
		<link href="../../css/china_antique.css" rel="stylesheet" />
		<link href="../../css/iconfont.css" rel="stylesheet" />
		<link href="../../css/swiper.min.css" rel="stylesheet" />
		<link href="../../css/layer.css" rel="stylesheet" />
		<script src="../../js/jquery-1.11.3.js" type="text/javascript"></script>
		<script src="../../js/rem.js" type="text/javascript"></script>
		<script src="../../js/swiper.min.js" type="text/javascript"></script>
		<script src="../../js/config.js"></script>
		<!-- 生产环境版本，优化了尺寸和速度 -->
		<script src="https://cdn.jsdelivr.net/npm/vue"></script>
		<script src="../../js/layer.js"></script>
		<title>资讯详情</title>
	</head>
	<body>
		<div id="infor_detail">
			<!-- banner -->
			<div  class="index_div infor_detailbanner">
				<!-- Swiper -->
				<div class="swiper-container">
					<div class="swiper-wrapper">
					  <div class="swiper-slide"><img :src="details.images"></div>
					</div>
					<!-- Add Pagination -->
					<div class="swiper-pagination"></div>
				</div>
				<p class="state_red">正在进行  {{details.dismount_time}} 结束</p>
				<!-- Swiper JS -->
				<script src="../../js/swiper.min.js" type="text/javascript"></script>
				<!-- Initialize Swiper -->
				<script>
				var swiper = new Swiper('.swiper-container', {
				  pagination: {
					el: '.swiper-pagination',
				  },
				});
				</script>
			</div>
		
			<div class="infor_content">
				<p class="infor_title">{{details.name}}</p>
				<p class="infor_mess">
					<span class="infor_time">结束时间：{{details.created_time}}
					</span>
					<span class="infor_seedetail" @click="getSeemoreFun()">查看链接</span>
				</p>
				<div class="seemorelink">
					<textarea cols="20" rows="1" id="copy_link" style="opacity: 0;display: block;">{{link}}</textarea>
					<input type="button" @Click="copyUrl2()" :value="link" class="copy_write" />
					<i class="iconfont" @Click="copyUrl2()">&#xe648;</i>
				</div>
				
			</div>
			<h1 class="center_img"><img src="../../img/banner01.png"></h1>
			
			<div class="infor_content">
				<p class="infor_uptitle">拍品详情</p>
				<div class="infor_updetail">
				</div>
			</div>
			
			<footer class="infor_footer">
				<span class="colect_btn" @click="colectFun()">收藏</span>
				<span class="assess_btns" @click="assessFun()">鉴定评估</span>
			</footer>
		</div>
	</body>
	<script>
		const loginIn = _Config_.API_PATH + '/api/login'; // 登陆
		const infordetail = _Config_.API_PATH + '/api/getRealDetail'//广告列表
		const colectinfo = _Config_.API_PATH + '/api/addCollection'//收藏
		var useris_vip = localStorage.getItem('useris_vip');
		function GetUrlParam(paraName) {
			var url = document.location.toString();
			var arrObj = url.split("?");
			if (arrObj.length > 1) {
				var arrPara = arrObj[1].split("&");
				var arr;
				for (var i = 0; i < arrPara.length; i++) {
					arr = arrPara[i].split("=");
		 
					if (arr != null && arr[0] == paraName) {
						return arr[1];
					}
				}
				return "";
			}
			else {
				return "";
			}
		}
		var real_id = GetUrlParam("real_id") //获取资讯id
		console.log(real_id)
		var user_id = localStorage.getItem("user_id");
		new Vue({
		    el:"#infor_detail",
		    data:function() {
				return{
					details:{},
					link:'',
				}
		    },
			mounted(){
				this.infordetailApi();
			},
		    methods:{
				// 资讯详情
				infordetailApi (){
					createAjax({
						type: 'GET',
						dataType: 'JSON',
						url: infordetail,
						data: {	
							real_id:real_id,
							user_id:user_id
						}
					}).success(res => {
						console.log(res);
						this.details = res.data;
						if(res.data.link){
							this.link = res.data.link;
						}
						if(res.data){
							$(".infor_updetail").html(res.data.images_detail)
							
						}else{
							console.log("banner暂未更新！")
						}	
					}).error(err => {
						console.log(err);
					})
				},
				colectFun () {
					createAjax({
						type: 'POST',
						dataType: 'JSON',
						url: colectinfo,
						data: {	
							real_id:real_id,
							user_id:user_id
						}
					}).success(res => {
						console.log(res);
						layer.msg('收藏成功！');
						// alert(res.msg);
						
					}).error(err => {
						console.log(err);
					})
				},
				assessFun(){
					if(this.link){
						window.location.href='../assess/assess_uplade.html?link='+this.link+'&';
					}else{
						window.location.href='../assess/assess_uplade.html'
					}
				},
				getSeemoreFun(){
					console.log(useris_vip)
					if(useris_vip == 1){
						$(".seemorelink").show();
					}else{
						window.location.href='../personal/member.html'
					}
					
				},
				// 一键复制代码
				copyUrl2(){
					var Url2 = document.getElementById("copy_link");
					Url2.select(); // 选择对象
					document.execCommand("Copy"); // 执行浏览器复制命令
					layer.msg("已复制好，可贴粘。");
				}
			},
		})
		
	</script>
</html>
